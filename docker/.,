FROM vllm/vllm-openai:v0.8.3

WORKDIR /app 


# ENV HF_ENDPOINT=https://hf-mirror.com
# RUN huggingface-cli download --resume-download yang31210999/Llama3.1-1B-Neo-BAAI-1000k --local-dir /models/Llama3.1-1B

ENV http_proxy 'http://proxy.cse.cuhk.edu.hk:8000'
ENV https_proxy 'http://proxy.cse.cuhk.edu.hk:8000'
RUN pip install toml pandas datasets matplotlib
# RUN pip install -i https://pypi.tuna.tsinghua.edu.cn/simple toml pandas datasets matplotlib

RUN echo '[model]' >> conf.toml && \
    echo 'MODEL_NAME = "Llama3.1-1B"' >> conf.toml && \
    echo 'PORT = 6008' >> conf.toml

COPY vllm_start vllm_start
COPY benchmark benchmark
ENTRYPOINT ["bash", "-c", "while true; do sleep 1000; done"]
# ENTRYPOINT ["python3", "-u", "vllm_start/vllm_start_up.py"]
